/* @settings

name: Cupertino
id: cupertino
settings:
    -
        id: cupertino-desc
        description: Most of the settings are for **turning off** Cupertino customizations. You don't need to change anything if you want to keep all default Cupertino optimizations.
        type: info-text
        markdown: true
    -
        id: alt-heading-off
        title: Disable alternative heading style
        description: Turn off all caps and opacity adjustment for H4, H5 and H6.
        type: class-toggle
    -
        id: active-line-off
        title: Disable active editing line highlight
        type: class-toggle
    -
        id: full-table-off
        title: Disable full width table
        type: class-toggle
    -
        id: hide-frontmatter-off
        title: Show frontmatter foldable heading
        type: class-toggle
    -
        id: desktop-header
        title: Desktop & Tablet
        type: heading
        level: 1
    -
        id: accented-frame-opacity
        title: Accented window
        description: Higher value reduces overall interface contrast.
        type: variable-number-slider
        default: 0
        min: 0
        max: 100
        step: 5
    -
        id: force-macos
        title: Use macOS style on Windows
        description: Turn off Windows specific styling. (Requires reload)
        type: class-toggle
    -
        id: alt-font-off
        title: Disable Apple Notes font style
        description: Turn off alternative lowercase 'a' font style. (Desktop)
        type: class-toggle
    -
        id: hide-nav-header-off
        title: Disable auto hiding panel actions
        type: class-toggle
    -
        id: center-status-off
        title: Disable centered status bar
        type: class-toggle
    -
        id: center-tabs-off
        title: Disable centered tabs
        type: class-toggle
*/

/* General */

body {
  --background-modifier-border: var(--divider-color);
  --background-modifier-border-focus: hsla(var(--interactive-accent-hsl), 0.5);
  --background-modifier-message: var(--background-secondary);
  --background-modifier-hover: rgba(var(--mono-rgb-100), 0.05);
  --blockquote-border-color: var(--color-base-50);
  --blockquote-border-thickness: 4px;
  --caret-color: var(--text-accent);
  --callout-padding: 16px;
  --callout-radius: var(--radius-s);
  --checkbox-radius: var(--radius-xl);
  --code-background: var(--background-secondary);
  --code-white-space: pre-wrap;
  --code-size: var(--font-smaller);
  --code-background: var(--background-primary-alt);
  --code-normal: var(--text-muted);
  --code-comment: var(--text-faint);
  --code-function: var(--color-orange);
  --code-important: var(--color-orange);
  --code-keyword: var(--color-red);
  --code-property: var(--color-blue);
  --code-punctuation: var(--text-muted);
  --code-string: var(--color-cyan);
  --code-tag: var(--color-red);
  --code-value: var(--color-purple);
  --dialog-width: 320px;
  --divider-color-hover: var(--text-normal);
  --dropdown-background-size: var(--icon-s);
  --dropdown-padding: 4px 16px 4px 8px;
  --font-text-theme: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Pingfang TC";
  --font-interface-theme: "SF Symbols", -apple-system, BlinkMacSystemFont, "SF Pro Text", "Pingfang TC";
  --h1-size: 1.5em;
  --h2-size: 1.375em;
  --h3-size: 1.25em;
  --h4-size: 1em;
  --h5-size: 0.875em;
  --h6-size: 0.85em;
  --icon-opacity: 1;
  --input-height: 24px;
  --input-radius: var(--radius-m);
  --input-shadow: 0px 0.5px 2.5px 0px rgba(0, 0, 0, 0.3), 0px 0px 0px 0.5px rgba(0, 0, 0, 0.05) !important;
  --link-decoration: none;
  --link-external-decoration: none;
  --list-spacing: 0.2em;
  --metadata-padding: 0;
  --metadata-property-radius-focus: var(--input-radius);
  --metadata-property-radius-hover: var(--input-radius);
  --metadata-property-radius: var(--input-radius);
  --modal-background: rgb(from var(--background-primary) r g b / 75%) !important;
  --nav-item-color: var(--text-normal);
  --nav-item-padding: 8px 8px 8px 24px;
  --radius-l: 12px;
  --radius-m: 6px;
  --radius-s: 6px;
  --radius-xl: 12px;
  --ribbon-background-collapsed: transparent;
  --ribbon-background: transparent;
  --ribbon-padding: 4px 0 0 8px;
  --ribbon-width: 48px;
  --slider-track-height: 4px;
  --slider-track-background: var(--background-modifier-border-hover);
  --tab-background-active: var(--background-primary-alt);
  --tab-container-background: transparent;
  --tab-divider-color: transparent;
  --tab-radius-active: var(--radius-s);
  --tab-radius: var(--radius-s);
  --table-background: var(--background-secondary);
  --tag-padding-x: 12px;
  --tag-padding-y: 8px;
  --text-highlight-bg: rgba(var(--color-orange-rgb), 0.25);
  --text-selection: var(--background-modifier-hover);
  --titlebar-background-focused: transparent;
  --titlebar-background: transparent;
  --toggle-border-width: 1px;
  --toggle-s-border-width: var(--toggle-border-width);
  --toggle-s-thumb-height: var(--toggle-thumb-height);
  --toggle-s-thumb-width: var(--toggle-thumb-width);
  --toggle-s-width: var(--toggle-width);
  --toggle-thumb-height: 13px;
  --toggle-thumb-width: 13px;
  --toggle-width: 26px;
  --workspace-background-translucent: rgb(from var(--background-primary) r g b / 75%);

  /* Light Theme */
  &.theme-light {
    --background-modifier-cover: rgba(170, 170, 170, 0.6);
    --background-modifier-border-hover: var(--color-base-25);
    --color-red-rgb: 255, 59, 48;
    --color-red: #ff3b30;
    --color-orange-rgb: 255, 149, 0;
    --color-orange: #ff9500;
    --color-yellow-rgb: 255, 204, 0;
    --color-yellow: #ffcc00;
    --color-green-rgb: 40, 205, 65;
    --color-green: #28cd41;
    --color-cyan-rgb: 85, 190, 240;
    --color-cyan: #55bef0;
    --color-blue-rgb: 0, 122, 255;
    --color-blue: #007aff;
    --color-purple-rgb: 175, 82, 222;
    --color-purple: #af52de;
    --color-pink-rgb: 255, 45, 85;
    --color-pink: #ff2d55;
    --divider-color: rgba(0, 0, 0, 0.05) !important;
    --modal-border-color: rgba(0, 0, 0, 0.1);
    --prompt-border-color: var(--modal-border-color);
  }

  /* Dark Theme */
  &.theme-dark {
    --background-modifier-cover: rgba(0, 0, 0, 0.6);
    --color-red-rgb: 255, 69, 58;
    --color-red: #ff453a;
    --color-orange-rgb: 255, 159, 10;
    --color-orange: #ff9f0a;
    --color-yellow-rgb: 255, 214, 10;
    --color-yellow: #ffd60a;
    --color-green-rgb: 50, 215, 75;
    --color-green: #32d74b;
    --color-cyan-rgb: 90, 200, 245;
    --color-cyan: #5ac8f5;
    --color-blue-rgb: 10, 132, 255;
    --color-blue: #0a84ff;
    --color-purple-rgb: 191, 90, 242;
    --color-purple: #bf5af2;
    --color-pink-rgb: 255, 55, 95;
    --color-pink: #ff375f;
    --divider-color: rgba(255, 255, 255, 0.05) !important;
    --modal-border-color: rgba(0, 0, 0, 1);
    --prompt-border-color: var(--modal-border-color);
  }

  &:not(.is-mobile) {
    --icon-xl: 24px;

    &.theme-light {
      --shadow-s: 0px 0px 2px 1px rgba(255, 255, 255, 0.5) inset, 0px 1px 2px rgba(0, 0, 0, 0.028), 0px 3.4px 6.7px rgba(0, 0, 0, 0.042), 0px 15px 30px rgba(0, 0, 0, 0.07);
      --shadow-l: 0px 0px 2px 1px rgba(255, 255, 255, 0.5) inset, rgba(0, 0, 0, 0.56) 0px 22px 70px 4px;
    }
    &.theme-dark {
      --shadow-s: 0px 0px 1px 0px rgba(255, 255, 255, 0.8) inset, 0px 1px 2px rgba(0, 0, 0, 0.028), 0px 3.4px 6.7px rgba(0, 0, 0, 0.042), 0px 15px 30px rgba(0, 0, 0, 0.07);
      --shadow-l: 0px 0px 1px 0px rgba(255, 255, 255, 0.8) inset, rgba(0, 0, 0, 0.56) 0px 22px 70px 4px;
    }
  }

  &:not(.is-phone) {
    --header-height: 48px;
  }

  &.is-mobile {
    --background-modifier-form-field: var(--interactive-normal) !important;
    --checkbox-size: var(--icon-l);
    --divider-color: var(--color-base-25);
    --icon-xs-stroke-width: 2px;
    --icon-s-stroke-width: 1.5px;
    --icon-m-stroke-width: 1.5px;
    --icon-l-stroke-width: 1.5px;
    --icon-xl-stroke-width: 1px;
    --input-height: 48px;
    --input-radius: 10px;
    --interactive-normal: var(--background-primary);
    --modal-background: rgb(from var(--background-secondary) r g b / 75%) !important;
    --mobile-sidebar-width: 100%;
    --mobile-toolbar-height: 48px;
    --nav-item-background-active: var(--color-accent);
    --nav-item-background-selected: var(--color-accent);
    --nav-item-color-active: var(--text-on-accent);
    --nav-item-padding: 16px;

    --radius-l: 16px;
    --radius-m: 10px;
    --radius-s: 10px;
    --radius-xl: 16px;
    --shadow-s: rgba(0, 0, 0, 0.1) 0px 8px 30px;
    --tab-switcher-background: transparent;
    --tab-switcher-menubar-background: transparent;
    --toolbar-option-width: calc(16px + var(--mobile-toolbar-height));
    padding: 0;

    &.theme-dark {
      --interactive-normal: var(--background-secondary);
    }
  }

  &.is-phone {
    --border-width: 1px;
    --divider-width: 1px;
    --mobile-sidebar-max-width: 100%;
    --tab-outline-width: 1px;
  }

  &.is-tablet {
    --dropdown-padding: 4px 40px 4px 20px;
  }

  &:not(.is-focused) {
    --workspace-background-translucent: var(--background-secondary);
  }
}

/********** Cupertino Helper: Pseudo Mica **********/

body.cupertino-helper {
  &::before {
    position: fixed;
    transform-origin: top left;
    z-index: -1;
    background-position: center;
    background-size: cover;
    content: "";
  }
  &:has(.empty-state-action:first-child):has(.workspace-tab-header.is-active[aria-label="New tab"]),
  &:has(.empty-state-action:first-child):has(.workspace-tab-header.is-active[aria-label="No file"]) {
    --workspace-background-translucent: rgb(from var(--background-primary) r g b / 50%) !important;
  }
}

/********** Animation **********/

@keyframes fadeInUp {
  0% {
    transform: translateY(16px);
    opacity: 0;
  }
}

@keyframes fadeInDown {
  from {
    transform: translateY(-16px);
    opacity: 0;
  }
}

@keyframes fadeInScale {
  from {
    transform: scale(0.95);
    opacity: 0;
  }
}

/* Startup animation */

body:has(.progress-bar-container) .app-container,
.progress-bar-container {
  opacity: 0;
}

body.is-phone:has(.mobile-tab-switcher) .app-container,
body.is-phone:has(.mobile-image-viewer) .app-container {
  transform: scale(0.95);
  opacity: 0.3;
  filter: blur(50px);
}

body,
body .app-container,
body.is-mobile .app-container,
body.is-phone .app-container,
body.is-tablet .app-container {
  transition: all var(--anim-duration-moderate) !important;
  overflow: hidden;
}

body:not(.is-mobile) {
  .workspace-ribbon,
  .workspace-split.mod-root,
  .workspace-split,
  .workspace-tabs .workspace-leaf,
  .workspace-split.mod-left-split .workspace-sidedock-vault-profile {
    background-color: transparent;
  }

  &:not(.is-translucent) .horizontal-main-container {
    background-color: var(--background-secondary);
  }

  .workspace {
    transition: background-color var(--anim-duration-slow) !important;
    background-color: hsla(var(--color-accent-hsl), calc(var(--accented-frame-opacity) * 0.005));
  }

  .workspace-sidedock-vault-profile {
    border: none !important;
    --vault-profile-color: var(--text-muted);
    --icon-color: var(--text-muted);
  }
}

body.is-tablet {
  top: var(--safe-area-inset-top);
}

/********** Input Components **********/

.clickable-icon {
  transition: all 0.1s ease-in-out !important;
  padding: 4px 8px;
}
.checkbox-container {
  box-shadow: 0px 0px 1px 0px rgba(0, 0, 0, 0.02) inset, 0px 0.5px 1.5px 0px rgba(0, 0, 0, 0.12) inset;

  &.is-enabled {
    box-shadow: 0px 0.5px 2.5px 0px rgba(102, 102, 102, 0.75) inset;
    background: linear-gradient(180deg, rgba(102, 102, 102, 0.75) 0%, rgba(102, 102, 102, 0) 67.71%), var(--interactive-accent);
    background-blend-mode: overlay, normal;
  }

  &::after {
    box-shadow: 0px 0.2px 0.25px 0px rgba(0, 0, 0, 0.12);
  }
}

.is-flashing {
  --text-highlight-bg: hsla(var(--color-accent-hsl), 0.25);
}

.search-input-container {
  display: flex;
  align-items: center;
}

.search-input-container:before {
  top: unset;
}

body:not(.is-mobile) {
  textarea,
  input[type="text"]:not(.metadata-container *):not(.prompt *),
  input[type="number"],
  input[type="search"],
  button:not(.clickable-icon),
  select,
  .dropdown {
    box-shadow: var(--input-shadow);
    border: none;
    height: unset;
    min-height: var(--input-height);
    font-weight: normal;
    line-height: unset;
  }

  input[type="text"]:not(.metadata-container *):not(.prompt *),
  input[type="number"] {
    box-shadow: none;
    border: 1px solid var(--background-modifier-border);
    background-color: transparent;
  }

  input[type="search"] {
    box-shadow: none;
    border: 1px solid var(--background-modifier-border);
  }

  button {
    padding: 4px 8px;
  }
  button[class*="mod-"]:not(.mod-destructive) {
    position: relative;
    box-shadow: 0px 1px 2.5px 0px hsla(var(--color-accent-hsl), 0.24), 0px 0px 0px 0.5px hsla(var(--color-accent-hsl), 0.12) !important;
    overflow: hidden;

    &:not(.mod-cancel):not(.mod-destructive)::before {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.17) 0%, rgba(255, 255, 255, 0) 100%);
      content: "";
    }
  }
  select,
  .dropdown {
    padding: 4px 32px 4px 8px;
  }
}

body.is-mobile {
  button,
  select,
  .dropdown {
    box-shadow: none !important;
  }

  .clickable-icon {
    background-color: transparent;
    padding: 8px;
  }
}

body.is-phone {
  textarea,
  input[type="text"]:not(.metadata-container *):not(.prompt *),
  input[type="number"],
  button:not(.clickable-icon):not(.modal:not(.mod-settings):not(.mod-community-modal) *):not(.view-content *),
  select,
  .dropdown {
    justify-content: flex-start;
    background-color: var(--interactive-normal);
    padding: 0 16px;
    min-height: var(--input-height);
    font-weight: normal;
    text-align-last: unset;
  }

  button:not(.clickable-icon):not(.modal:not(.mod-settings):not(.mod-community-modal) *):not(.view-content *),
  select,
  .dropdown {
    color: var(--text-accent);
  }

  .setting-item-control button {
    color: var(--text-accent);
  }
}

body.is-tablet {
  textarea,
  input[type="text"]:not(.metadata-container *):not(.prompt *),
  input[type="number"],
  button:not(.clickable-icon):not(.modal:not(.mod-settings) *):not(.view-content *) {
    padding: 4px 20px;
  }
}

/********** Ribbon & Sidebar **********/

.side-dock-settings,
.side-dock-actions {
  gap: 4px;
}

.nav-files-container > div {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.tree-item-self {
  align-items: center;
  transition: background-color var(--anim-duration-fast);
  margin-bottom: 0;
  letter-spacing: -0.015em;

  &:hover {
    cursor: pointer;
  }
}
.tree-item-self.is-active .tree-item-icon svg {
  color: var(--text-on-accent);
}
.search-results-info .dropdown {
  box-shadow: none !important;
  background-color: transparent;
}
.search-results-children .tree-item-inner {
  color: var(--text-normal);
}

body:not(.is-mobile) {
  .workspace .workspace-ribbon,
  .workspace .workspace-ribbon.mod-left:before,
  .workspace .mod-sidedock > .workspace-leaf-resize-handle {
    border: none;
  }
  .workspace-split.mod-sidedock .workspace-leaf-content > .node-insert-event,
  .workspace-split.mod-sidedock .workspace-leaf-content > .view-content {
    padding: 4px 16px;
  }

  &.show-ribbon {
    .workspace-ribbon .sidebar-toggle-button {
      justify-content: flex-end;
    }
    .workspace-tabs.mod-top-left-space .workspace-tab-header-container {
      padding-left: 0;
    }
    .workspace-split.mod-sidedock .workspace-leaf-content > .node-insert-event,
    .workspace-split.mod-sidedock .workspace-leaf-content > .view-content,
    .nav-header {
      padding-left: 8px;
    }
    .search-row {
      margin-left: 8px;
    }
  }

  .view-content > .node-insert-event {
    padding: 0;
  }

  .search-row {
    margin: 4px 16px;
  }

  /* Unfocused window opacity */
  &:not(.is-focused) .mod-sidedock > * {
    opacity: 0.5;
  }

  .view-content .nav-header {
    padding: 4px 0;
  }
  .nav-header {
    padding: 4px 16px;
  }

  /* Auto hide panel actions */
  &:not(.hide-nav-header-off) .nav-header {
    *,
    *::before {
      transition: all var(--anim-duration-fast) !important;
    }

    &:not(:hover):not(:has(.is-active)):not(:has(.has-active-menu)) .nav-buttons-container {
      gap: 4px;
      background-color: transparent;
      padding: 0;

      .nav-action-button {
        flex-grow: 0;
        background-color: var(--background-modifier-border-hover);
        padding: 2px;
        width: unset;
        height: unset;
      }
      svg,
      .nav-action-button::before {
        --icon-size: 0px;
        font-size: 0px;
      }
    }
  }

  /* Panel actions style */
  .nav-buttons-container {
    border-radius: calc(var(--clickable-icon-radius) + 2px);
    background-color: var(--background-modifier-hover);
    padding: 2px;
  }
  .nav-action-button {
    position: relative;
    flex-grow: 1;
    padding: 4px;
    height: 100%;
  }
  .nav-action-button.is-active,
  .nav-action-button.is-active:hover {
    box-shadow: 0px 0.25px 0.25px 0px rgba(0, 0, 0, 0.15), 0px 1px 0.75px 0px rgba(0, 0, 0, 0.05);
    background-color: var(--background-primary);
    color: var(--icon-color);
  }

  /* Hide indent line */
  .tree-item-children {
    margin-bottom: 0;
    border-inline-start: none;
  }

  /* Text positioning */
  .tree-item-self:not(.mod-collapsible):has(.tree-item-icon) {
    gap: 4px;
  }
}

body.is-mobile {
  &.theme-dark {
    .workspace-drawer {
      background-color: var(--background-primary);

      .view-content > *:not(.nav-header) {
        background: var(--background-secondary);
      }

      .view-content[style*="padding: 0"] {
        display: none;
      }
    }
  }

  .workspace-drawer-backdrop {
    background-color: transparent;
  }

  .workspace-drawer {
    border-radius: 0;
    background-color: var(--background-secondary);

    .workspace-drawer-inner {
      background-color: transparent;
    }
    .workspace-drawer-header-info {
      font-size: var(--font-ui-smaller);
    }

    .workspace-drawer-active-tab-container {
      background-color: transparent;
    }
    .workspace-drawer-active-tab-header {
      margin: 0;
      background-color: transparent;
      padding: 0 24px;

      select {
        width: auto;
      }
    }
    .workspace-drawer-active-tab-icon {
      display: none;
    }
    .workspace-drawer-active-tab-title {
      flex-grow: 0;
      color: var(--text-accent);
    }
    .workspace-drawer-active-tab-chevron {
      margin-inline-start: 0;
      color: var(--text-accent);
    }

    .view-content {
      padding: 12px 16px 32px;
      overflow: auto;
    }
    .view-content > *:not(.nav-header) {
      border-radius: var(--input-radius);
      background: var(--background-primary);

      &:not(.node-insert-event) {
        padding: 8px 16px !important;
      }
    }
    .view-content:has(.nav-header) > *:not(.nav-header) {
      margin-bottom: 80px;
      overflow: visible;
    }
    .search-result-file-title {
      color: var(--text-normal);
    }
    .search-result-file-matches {
      margin: 0;
      box-shadow: none;
      border: 1px solid var(--background-modifier-border);
    }
    .search-result-file-match {
      padding: 16px;
    }
  }

  .nav-files-container {
    padding: 8px 16px !important;

    & > div {
      gap: 0;
      margin-bottom: 80px;
      border-radius: var(--input-radius);
      background-color: var(--interactive-normal);
      overflow: hidden;
    }
    .tree-item {
      position: relative;
      border-radius: 0;
    }
    .tree-item:not(:last-child)::before {
      position: absolute;
      right: 0;
      bottom: 0;
      border-bottom: 1px solid var(--background-modifier-border);
      width: 100%;
      content: "";
    }
    .tree-item-self {
      border-radius: 0;
      padding-inline-end: var(--nav-item-parent-padding);
    }
    .tree-item-children {
      position: relative;
      margin-bottom: 0;
      border-inline-start: none;
    }
    .tree-item-children::before {
      position: absolute;
      top: 0;
      right: 0;
      border-top: 1px solid var(--background-modifier-border);
      width: calc(100% + var(--nav-item-children-margin-start));
      content: "";
    }
    .tree-item-icon.collapse-icon {
      right: var(--nav-item-parent-padding);
      margin-inline-start: unset;
    }
  }
}

body.is-tablet {
  .side-dock-ribbon,
  .side-dock-actions {
    padding: 0;
  }
}

/********** Tabs **********/

body:not(.is-mobile) {
  .workspace-tab-header-container {
    padding: 8px;
  }
  .workspace-tab-header-new-tab,
  .workspace-tab-header-tab-list,
  .sidebar-toggle-button {
    padding: 8px 0 !important;
  }

  .workspace-tab-header-container .clickable-icon {
    height: 100%;
  }

  .workspace-split.mod-sidedock .workspace-tab-header-inner,
  .sidebar-toggle-button .clickable-icon,
  .side-dock-ribbon-action {
    margin: unset !important;
    width: 40px;
    min-width: 40px;
  }
  .side-dock-ribbon-action {
    height: 32px;
  }
  .workspace-tab-header-new-tab .clickable-icon {
    width: 32px;
    min-width: 32px;
  }
  .workspace-tab-header-tab-list .clickable-icon {
    padding: 0;
    width: 16px;
    min-width: 16px;

    &::before {
      --icon-size: 12px;
    }
  }

  .sidebar-toggle-button .clickable-icon {
    margin: auto 0;
  }

  .mod-sidedock .workspace-tab-header-container-inner {
    gap: 0;
    transition: var(--anim-duration-fast);
    box-sizing: border-box;
    border-radius: var(--tab-radius);
    padding: 0;

    &:hover {
      background-color: var(--background-modifier-hover);
    }
  }
  .mod-sidedock .workspace-tab-header {
    background-color: transparent;

    &:not(:hover):not(.is-active) {
      --icon-opacity: 0.5;
    }
  }

  .mod-left-split .workspace-tab-header-container-inner,
  .mod-right-split .workspace-tab-header-container-inner {
    margin: 0;
  }
  .mod-top-right-space .workspace-tab-header-container-inner {
    margin: 0;
  }

  .workspace-split.mod-root.mod-vertical .workspace-leaf-resize-handle,
  .workspace-split.mod-root.mod-horizontal .workspace-leaf-resize-handle {
    border-color: transparent !important;
  }
}

body:not(.is-phone) {
  .sidebar-toggle-button.mod-left {
    position: absolute !important;
    top: 0;
  }

  .sidebar-toggle-button.mod-left,
  .sidebar-toggle-button.mod-right {
    position: absolute;
    height: var(--header-height);
  }

  .workspace-tab-header-container {
    border-bottom: none;
  }

  /* Editor Panel */
  .workspace .mod-root {
    .workspace-tabs:not(.mod-stacked) {
      overflow: visible;

      &.mod-active,
      hr {
        z-index: var(--layer-sidedock);
      }

      .workspace-tab-header-container {
        align-items: center;
        gap: 4px;
        padding-right: 8px !important;
      }
      .workspace-tab-header-container-inner {
        align-items: center;
        gap: 4px;
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: scroll;
      }

      .workspace-tab-header {
        flex: unset;
        background-color: var(--background-modifier-hover);
        padding: 0;
        min-width: 100px;
        height: 100%;

        &.is-active {
          box-shadow: none;
          min-width: 200px;
        }

        &:not(.is-active) {
          opacity: 0.5;
        }

        &::before,
        &::after {
          display: none;
        }
      }

      .workspace-tab-header-inner {
        padding: 0 32px 0 12px !important;
      }
      .workspace-tab-header-inner-title {
        line-height: normal;
      }
      .workspace-tab-header-inner-close-button {
        position: absolute;
        opacity: 0.5;
        inset-inline-end: 8px;
      }

      .workspace-tab-header-new-tab,
      .workspace-tab-header-tab-list {
        margin-inline-start: 0;
        margin-inline-end: 0;
        padding: 0 !important;
        height: 100%;
      }
    }
  }

  &.center-tabs-off .workspace .mod-root {
    .sidebar-toggle-button.mod-right {
      position: relative;
      right: 0 !important;
    }
  }

  &:not(.center-tabs-off) .workspace .mod-root {
    --tab-width: 100%;

    .workspace-tab-header-container {
      justify-content: center;
      gap: 0;
    }
    .workspace-tab-header-container:not(:has(.sidebar-toggle-button.mod-left)) {
      padding-left: 0;
    }
    .workspace-tab-header-container:not(:has(.sidebar-toggle-button.mod-right)) {
      padding-right: 0;

      .workspace-tab-header-new-tab {
        right: 24px !important;
      }
      .workspace-tab-header-tab-list {
        right: 8px !important;
      }
    }

    .workspace-tab-header {
      width: fit-content;
    }

    .workspace-tabs:not(:has(.sidebar-toggle-button)) .workspace-tab-header-container {
      padding-right: 60px !important;
      padding-left: 60px !important;
    }

    .workspace-tab-header-spacer {
      display: none;
    }
    .workspace-tab-header-new-tab,
    .workspace-tab-header-tab-list {
      position: absolute;
    }
    .workspace-tab-header-new-tab .clickable-icon:hover {
      border-radius: var(--clickable-icon-radius) 0 0 var(--clickable-icon-radius) !important;
    }
    .workspace-tab-header-new-tab:has(.clickable-icon:hover) ~ .workspace-tab-header-tab-list .clickable-icon {
      opacity: var(--icon-opacity-hover);
      border-radius: 0 var(--clickable-icon-radius) var(--clickable-icon-radius) 0 !important;
      background-color: var(--background-modifier-hover);
      color: var(--icon-color-hover);
    }
  }
}

body.mod-macos:not(.is-mobile) {
  .mod-top-left-space .workspace-tab-header-container-inner {
    margin: 0 0 0 40px;
  }
  &.is-hidden-frameless:not(.is-popout-window) .sidebar-toggle-button.mod-right {
    right: 8px;
  }

  &.is-hidden-frameless.is-fullscreen:not(.is-popout-window):not(.is-left-sidedock-open) {
    .sidebar-toggle-button.mod-left {
      left: 8px;
    }

    &.show-ribbon {
      .sidebar-toggle-button.mod-left {
        left: -48px;
        z-index: 10;
      }
      .mod-top-left-space .workspace-tab-header-container-inner {
        margin: 0;
      }
    }
  }

  &.is-hidden-frameless:not(.is-popout-window):not(.is-fullscreen) {
    .workspace-tabs.mod-top-left-space .workspace-tab-header-container {
      padding-left: var(--frame-left-space);
    }

    .sidebar-toggle-button.mod-left {
      left: var(--frame-left-space);
    }

    .mod-root .workspace-tabs .workspace-tab-header-container {
      padding-right: calc(var(--frame-left-space) + 44px) !important;
      padding-left: calc(var(--frame-left-space) + 44px) !important;
    }
  }

  &:not(.center-tabs-off) .workspace:not(.is-right-sidedock-open) {
    &.is-left-sidedock-open {
      .mod-root .workspace-tabs .workspace-tab-header-container {
        padding-right: 100px !important;
        padding-left: 100px !important;
      }
    }
    .workspace-tab-header-new-tab {
      right: 64px;
    }
    .workspace-tab-header-tab-list {
      right: 48px;
    }
  }

  &:not(.center-tabs-off) .workspace.is-right-sidedock-open {
    &.is-left-sidedock-open {
      .mod-root .workspace-tabs .workspace-tab-header-container {
        padding-right: 60px !important;
        padding-left: 60px !important;
      }
    }
    .workspace-tab-header-new-tab {
      right: 24px;
    }
    .workspace-tab-header-tab-list {
      right: 8px;
    }
  }
}

body.mod-windows:not(.is-mobile),
body.mod-linux:not(.is-mobile) {
  &.is-frameless.is-hidden-frameless .titlebar {
    background-color: transparent;
  }

  &:not(.show-ribbon) .workspace:not(.is-left-sidedock-open) {
    .sidebar-toggle-button.mod-left {
      left: 8px;
    }
  }
  &:not(.show-ribbon) .mod-top-left-space .workspace-tab-header-container-inner {
    margin: 0 0 0 40px;
  }

  .workspace:not(.is-right-sidedock-open) {
    .sidebar-toggle-button.mod-right {
      right: calc(8px + var(--frame-right-space));
    }
    .mod-root .workspace-tabs .workspace-tab-header-container {
      padding-right: calc(100px + var(--frame-right-space));
      padding-left: calc(100px + var(--frame-right-space));
    }
    .workspace-tab-header-new-tab {
      right: calc(64px + var(--frame-right-space));
    }
    .workspace-tab-header-tab-list {
      right: calc(48px + var(--frame-right-space));
    }
  }

  .workspace.is-right-sidedock-open {
    .sidebar-toggle-button.mod-right {
      right: 8px;
    }
    .mod-root .workspace-tabs .workspace-tab-header-container {
      padding-right: 100px;
      padding-left: 100px;
    }
    .workspace-tab-header-new-tab {
      right: 64px;
    }
    .workspace-tab-header-tab-list {
      right: 48px;
    }
  }

  &.center-tabs-off {
    .workspace:not(.is-left-sidedock-open) {
      .mod-root .workspace-tabs .workspace-tab-header-container {
        padding-left: 52px;
      }
    }
    .workspace:not(.is-right-sidedock-open) {
      .mod-root .workspace-tabs .workspace-tab-header-container {
        padding-right: var(--frame-right-space) !important;
      }
    }
    .workspace.is-left-sidedock-open {
      .mod-root .workspace-tabs .workspace-tab-header-container {
        padding-left: 8px;
      }
    }
  }
}

body.is-tablet {
  &.is-frameless.is-hidden-frameless .titlebar {
    background-color: transparent;
  }

  &.center-tabs-off .sidebar-toggle-button.mod-left {
    position: relative !important;
    left: 0;
  }

  .sidebar-toggle-button.mod-left {
    left: 8px;
    padding-left: 0;
  }

  .sidebar-toggle-button.mod-right {
    right: 8px;
  }

  .workspace.is-right-sidedock-open .sidebar-toggle-button.mod-right {
    right: 8px;
  }

  .workspace .mod-root .workspace-tabs .workspace-tab-header-container {
    padding: 6px;
  }

  .workspace-tab-header-new-tab {
    right: 88px;
  }
  .workspace-tab-header-tab-list {
    right: 48px;
  }

  .workspace:has(.workspace-drawer.mod-right.is-pinned) .workspace-tab-header-new-tab {
    right: 48px;
  }

  .workspace:has(.workspace-drawer.mod-right.is-pinned) .workspace-tab-header-tab-list {
    right: 8px;
  }
}

/********** Editor **********/
.mod-root .workspace-leaf-content[data-mode="source"] .view-header .view-actions button:nth-last-child(2) {
  border: 1px solid var(--text-accent) !important;
  background-color: var(--interactive-accent) !important;
  color: var(--text-on-accent) !important;
}

.markdown-reading-view,
.markdown-source-view {
  transition: var(--anim-duration-fast) ease-in-out;
}

.workspace-leaf-content[data-mode="source"] .markdown-reading-view {
  transform: scale(0.99);
}

.workspace-leaf-content[data-mode="preview"] .markdown-source-view {
  transform: scale(0.99);
}

.workspace-tabs.mod-top {
  overflow: visible;
}

.mod-fade::before,
.mod-fade::after {
  display: none;
}

body:not(.active-line-off) .cm-active::before {
  position: absolute;
  top: 4px;
  bottom: 4px;
  left: -12px;
  border-left: 4px solid var(--interactive-accent);
  border-radius: var(--input-radius);
  content: "";
}

.inline-title {
  margin-bottom: 24px;
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 16px;
}

body:not(.alt-heading-off) {
  h4,
  .markdown-rendered h4 {
    opacity: 0.8;
    letter-spacing: normal;
  }

  h5,
  .markdown-rendered h5 {
    opacity: 0.5;
    letter-spacing: normal;
    text-transform: uppercase;
  }

  h6,
  .markdown-rendered h6 {
    opacity: 0.8;
    font-weight: 300;
    letter-spacing: normal;
    text-transform: uppercase;
  }
}

.markdown-rendered code,
.cm-s-obsidian .cm-inline-code:not(.cm-formatting) {
  border: 1px solid var(--background-modifier-border);
  padding: 2px 4px;
}

.markdown-rendered mark,
.cm-s-obsidian span.cm-formatting-highlight,
.cm-s-obsidian span.cm-highlight {
  border-radius: var(--radius-s);
  padding: 2px 4px;
  color: var(--color-orange);
}

.markdown-rendered.show-indentation-guide li > ul::before,
.markdown-rendered.show-indentation-guide li > ol::before,
.cm-s-obsidian .cm-indent {
  visibility: hidden;
}

.callout {
  background-color: rgba(var(--callout-color), 0.15);

  p:last-child {
    margin-bottom: 0;
  }

  pre {
    border: 1px solid var(--background-modifier-border);
  }
}

img {
  border-radius: var(--radius-s);
}

li:has(p) {
  --p-spacing: 0.5rem;

  &:not(:last-child) {
    padding-bottom: 1.2em;
  }
}

p:has(a.tag) {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.cm-html-embed td,
.markdown-rendered td,
.cm-html-embed th,
.markdown-rendered th,
.markdown-source-view.mod-cm6 .cm-table-widget .table-cell-wrapper {
  padding: 8px;
}

body:not(.full-table-off) table,
body:not(.full-table-off) .table-wrapper {
  width: 100% !important;
}

:root table {
  border-collapse: separate;
  border-spacing: 0;
}

:root :is(td, th) {
  border-width: 0 var(--table-border-width) var(--table-border-width) 0;
}

th {
  &:first-child {
    border-top-left-radius: var(--radius-s);
  }
  &:last-child {
    border-top-right-radius: var(--radius-s);
  }
}

tr {
  &:last-child td {
    &:first-child {
      border-bottom-left-radius: var(--radius-s);
    }
    &:last-child {
      border-bottom-right-radius: var(--radius-s);
    }
  }
}

body:not(.is-phone) {
  .view-header {
    padding: 0 8px;
  }

  .view-header-title-parent .view-header-breadcrumb,
  .view-header-title-parent .view-header-breadcrumb-separator {
    opacity: 0.5;
    color: var(--text-muted);
  }
}

body:not(.is-mobile) {
  &.theme-dark .mod-root .workspace-tab-container {
    box-shadow: rgba(244, 244, 244, 0.12) 0px 0px 0px 1px, rgba(0, 0, 0, 0.16) 0px 24px 48px, rgba(0, 0, 0, 0.12) 0px 4px 16px;
  }

  .mod-root .workspace-tab-container {
    margin-bottom: 8px;
    box-shadow: rgba(31, 34, 37, 0.09) 0px 0px 0px 1px, rgba(0, 0, 0, 0.04) 0px 24px 48px, rgba(0, 0, 0, 0.02) 0px 4px 16px;
    border-radius: var(--radius-l);
  }

  &:not(.show-ribbon) .workspace:not(.is-left-sidedock-open) .mod-root .workspace-tab-container {
    margin-left: 8px;
    border-radius: var(--radius-m);
  }
  .workspace:not(.is-right-sidedock-open) .mod-root .workspace-tab-container {
    margin-right: 8px;
    border-radius: var(--radius-m);
  }

  /* Auto Focus Mode */
  .app-container:has(.workspace:not(.is-left-sidedock-open):not(.is-right-sidedock-open)):not(:has(.empty-state-action:first-child):has(.workspace-tab-header.is-active[aria-label="New tab"])):not(:has(.empty-state-action:first-child):has(.workspace-tab-header.is-active[aria-label="No file"])) {
    .workspace {
      background-color: var(--background-primary);
    }

    .workspace-tab-container {
      margin: 0;
      box-shadow: none;
      border: none;
      border-radius: 0;
    }
    .workspace-tab-header-container:not(:hover),
    .view-header:not(:hover) {
      opacity: 0.5;
      transition: var(--anim-duration-fast);
    }
    .view-header,
    .view-content {
      background-color: transparent;
    }
    .status-bar:not(:hover) {
      opacity: 0;
    }
  }

  /* Alt font style */
  &:not(.alt-font-off) .mod-root .view-content * {
    font-feature-settings: "ss07" 1;
  }
}

body.is-mobile {
  .mod-root .view-content {
    background-color: var(--background-primary);
  }

  .markdown-preview-view .task-list-item-checkbox {
    top: 0.45em;
    margin-inline-start: calc((var(--checkbox-size) + 8px) * -1);
  }
}

body.is-phone {
  .markdown-preview-view:first-child,
  .cm-sizer:first-child {
    padding-top: calc(var(--safe-area-inset-top) + var(--view-header-height) + 16px);
  }

  .mod-root .view-content:not(:has(.markdown-source-view)):not(:has(.markdown-reading-view)):not(:has(.canvas-wrapper)) {
    margin-top: calc(var(--safe-area-inset-top) + var(--view-header-height) + 16px);
  }
}

/********** Frontmatter **********/
body:not(.hide-frontmatter-off) .metadata-properties-heading {
  display: none;
}

.metadata-container {
  --icon-size: 16px;
  transform: none;

  .metadata-properties-heading {
    padding: 16px 0 4px;
    color: var(--text-muted);
  }

  .metadata-properties {
    border-radius: var(--radius-s);
    background-color: var(--background-secondary);
  }

  .metadata-property-icon::before {
    display: none;
  }

  .metadata-property-key {
    align-items: center;
    border: none;
    padding: 0 8px 0 16px;
  }

  .metadata-property-value {
    border: none;
    min-height: 40px;
  }

  .metadata-add-button {
    gap: 8px;
    margin: 0;
    padding: 0 16px;
    width: 100%;
    height: 40px;
    color: var(--text-faint);
    font-weight: normal;
  }
}

body:not(.is-mobile) {
  .metadata-add-button {
    display: flex;
    transition: var(--anim-duration-fast);
    transition-delay: var(--anim-duration-moderate);
    cursor: pointer;
  }

  .metadata-container:not(:hover) .metadata-add-button {
    visibility: hidden;
    opacity: 0;
    height: 0;
  }

  .prompt.suggestion {
    border-radius: var(--radius-m);
    background-color: var(--background-secondary);
    padding: 6px;

    .suggestion-item {
      padding: 4px 8px;
      font-size: var(--font-ui-small);
    }
  }
}

body.is-mobile {
  &.theme-dark {
    .metadata-properties {
      background-color: var(--background-secondary);
    }
  }

  .metadata-property-key-input,
  .metadata-property-value {
    background-color: transparent;
  }

  .metadata-add-button {
    gap: 12px;
  }
}

/********** Modal **********/

.modal {
  .modal-header:empty,
  .modal-header:has(.modal-title:only-child:empty) {
    display: none;
  }
}

body:not(.is-mobile) {
  .modal.mod-community-modal {
    box-shadow: none;
  }

  .modal:not(.mod-settings):not(.mod-community-modal) {
    backdrop-filter: blur(50px);
    animation: var(--anim-duration-fast) fadeInDown;

    .modal-title,
    h1,
    h2,
    h3,
    p {
      text-align: center;
    }

    .modal-header {
      margin: 8px 0;
    }

    .modal-content:not(:has(:not(p))) {
      text-align: center;
    }

    .modal-button-container {
      justify-content: center;

      button {
        flex-grow: 1;
        width: 0;
      }

      .mod-checkbox {
        justify-content: center;
        margin-bottom: 8px;
        width: 100%;
      }
    }
  }
}

body.is-mobile {
  .mod-confirmation .modal:not(.mod-lg) {
    --interactive-normal: unset;
    backdrop-filter: blur(50px);
    background-color: var(--modal-background);
  }

  .modal .modal-header {
    border: none !important;
  }
}

body.is-phone {
  .modal {
    box-shadow: none !important;
    padding-bottom: var(--safe-area-inset-bottom);

    .modal-content {
      overflow: visible;
    }

    .modal-nav-action {
      margin-top: unset;
      box-shadow: none !important;
      background-color: transparent;
      padding: 16px 12px;
      height: unset;

      &:first-of-type {
        left: 16px;
      }
      &:last-of-type {
        right: 16px;
      }
    }
  }

  .modal:not([class*="mod-"]:not(.mod-file-rename)) {
    bottom: var(--safe-area-inset-bottom);
    backdrop-filter: blur(50px);
    box-shadow: none;
    border-radius: var(--radius-xl);
    padding: 0;
    width: 95%;

    .modal-header {
      border: none;
      padding: 24px 0 8px;
      color: var(--text-muted);
    }

    .modal-content {
      padding: 8px 16px 24px;
      color: var(--text-muted);
      text-align: center;
    }

    .modal-content p {
      margin: 0.1em;
    }

    .setting-item {
      margin-top: 16px;
      border: none;
    }

    textarea {
      line-height: var(--input-height);
    }

    .modal-button-container {
      gap: 0;
      margin: 0;
      padding: 0;

      button {
        justify-content: center;
        margin: 0;
        border-top: 1px solid var(--background-modifier-border);
        border-radius: 0;
        background-color: transparent;
        padding: 32px 0;
        color: var(--text-accent);
      }

      .mod-destructive,
      .mod-warning {
        color: var(--text-error);
      }
    }
  }
}

/********** Menu and Suggestions **********/

body:not(.is-mobile) .menu,
body:not(.is-mobile) .suggestion-container {
  outline: var(--prompt-border-width) solid var(--prompt-border-color);
  border: none;
  border-radius: var(--radius-m);
  background-color: var(--background-secondary);
  padding: 4px;

  .menu-separator {
    margin: 6px 8px;
  }

  .menu-item,
  .suggestion-item {
    border-radius: 4px;
  }
  .menu-item.selected:not(.is-label):not(.is-disabled),
  .suggestion-item.is-selected:not(.mod-group) {
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);

    .menu-item-icon {
      color: var(--text-on-accent);
    }
  }

  .suggestion {
    padding: 0;
  }
  .search-suggest-item.mod-group {
    margin: 0;
    padding: 4px 8px;
  }
  .search-suggest-item.mod-group:not(:first-child) {
    margin-top: 8px;
  }
  .search-suggest-item:not(.mod-group).is-selected {
    --text-muted: var(--text-on-accent);
  }
}

body.is-mobile {
  .menu {
    backdrop-filter: blur(50px);
    box-shadow: none;
    background-color: var(--modal-background);
    padding: 0;
    overflow: hidden;
    white-space: normal;
  }

  .menu-item:not(.is-label) {
    flex-direction: row-reverse;
    padding: 16px;
  }
  .menu-item-title {
    white-space: normal;
  }

  .menu-scroll {
    background-color: transparent;
    max-height: 80vh;
  }
  .menu-scroll:has(.mod-checked) .menu-item.tappable:not(:has(.mod-checked)) .menu-item-title {
    margin-left: calc(var(--icon-size) + 8px);
  }
  .menu-item-icon {
    justify-content: center;
    width: var(--icon-size);
  }
  .menu-item.is-label {
    border: none !important;
    background-color: transparent;
  }
  .menu-item:not(.is-label[data-section="title"]) {
    background-color: rgb(from var(--background-secondary-alt) r g b / 75%);
  }
  .menu-item:not(:has(+ .menu-separator)):not(:last-child) {
    border-bottom: 1px solid var(--background-modifier-border-hover);
  }

  .menu-separator {
    border: none;
  }

  .suggestion-container {
    backdrop-filter: blur(50px);
    border: none;
    background-color: rgb(from var(--background-secondary-alt) r g b / 75%) !important;

    .suggestion {
      padding: 0;
    }
    .suggestion-item {
      display: flex;
      align-items: center;
      margin: 0;
      border-bottom: 1px solid var(--background-modifier-border-hover);
      border-radius: 0;
      background-color: transparent;
      padding: 16px;
      min-height: var(--input-height);
    }
    .suggestion-item:last-child {
      border: none;
    }
  }
}

body.is-phone {
  .menu-grabber {
    position: absolute;
    top: 8px;
    align-self: center;
    width: 36px;
    height: 5px;
  }
  .menu-scroll {
    padding: 40px 16px var(--safe-area-inset-bottom);
  }
  .menu-item + .menu-item,
  .menu-item:has(+ .menu-item) {
    border-radius: 0;
  }
  .menu-separator + .menu-item,
  .menu-item:first-child:has(+ .menu-item) {
    border-top-right-radius: var(--radius-s);
    border-top-left-radius: var(--radius-s);
  }
  .menu-item:has(+ .menu-separator),
  .menu-item + .menu-item:last-child {
    border-bottom-right-radius: var(--radius-s);
    border-bottom-left-radius: var(--radius-s);
  }
}

body.is-tablet {
  .menu {
    background-color: transparent;
    min-width: 240px;
  }
  .menu-item {
    border-radius: 0;
  }
  .menu-item.is-label {
    padding: 8px;
  }
  .menu-item:not(.is-label[data-section="title"]) {
    background-color: rgb(from var(--background-secondary-alt) r g b / 50%);
  }
  .menu-separator {
    margin: 4px;
  }
}

/********** Prompt **********/

body:not(.is-phone) {
  .modal-container:has(.prompt) .modal-bg {
    background-color: transparent;
  }

  .prompt {
    backdrop-filter: blur(50px);
    outline: var(--prompt-border-width) solid var(--prompt-border-color);
    border: none;
    background-color: var(--workspace-background-translucent);
  }

  .prompt-input {
    border-color: var(--background-modifier-border);
    background-color: transparent;
    font-size: var(--font-ui-large);
  }

  .prompt-instructions {
    border-color: var(--background-modifier-border);
    color: var(--text-faint);
  }

  .prompt .suggestion-item {
    padding: 8px 16px;
  }
}

body.is-phone {
  &.theme-dark {
    .prompt-input-container {
      background: linear-gradient(180deg, rgba(43, 43, 43, 0) 0%, rgba(43, 43, 43, 1) 80%);
    }
  }

  &:has(.prompt) .app-container {
    filter: blur(20px) brightness(0.5);
  }
  .prompt {
    top: unset;
    bottom: 0;
    align-items: stretch;
    border-radius: 0;
    background-color: transparent !important;
    height: 100%;
    max-height: unset;
  }

  .prompt-input-container {
    position: fixed;
    bottom: 0;
    z-index: var(--layer-cover);
    border: none;
    background: linear-gradient(180deg, rgba(209, 211, 218, 0) 0%, rgba(209, 211, 218, 1) 100%);
    width: 100%;
  }

  .prompt-input[type="text"] {
    margin: 8px;
    border-radius: var(--radius-l);
    padding: 24px 24px;
  }

  .prompt-results {
    padding: 64px 12px;
  }

  .prompt .suggestion-item {
    padding: 16px;
    color: white;
  }
}

body.is-tablet {
  .prompt-input {
    background-color: transparent;
  }
}

/********** New Tab **********/

.view-header,
.view-content,
.workspace-tab-container {
  transition: all var(--anim-duration-fast);
}

body:has(.empty-state-action:first-child):has(.workspace-tab-header.is-active[aria-label="New tab"]),
body:has(.empty-state-action:first-child):has(.workspace-tab-header.is-active[aria-label="No file"]) {
  --workspace-background-translucent: transparent !important;
}
body:has(.empty-state-action:first-child:not(:hover)):has(.workspace-tab-header.is-active[aria-label="New tab"]),
body:has(.empty-state-action:first-child:not(:hover)):has(.workspace-tab-header.is-active[aria-label="No file"]) {
  .mod-root .view-header,
  .mod-root .view-content,
  .workspace-tab-container {
    box-shadow: none;
    border-color: transparent !important;
    background-color: transparent;
  }

  .status-bar {
    display: none;
  }
}

.empty-state-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 0;
  padding: var(--file-margins);
  width: 100%;
  max-width: 100%;
  height: 100%;
  max-height: 100%;
}

.empty-state-container::before {
  -webkit-mask-size: contain;
  -webkit-mask-position: center;
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="140" height="180" viewBox="0 0 140 180" fill="none"><path d="M49.775 105.089C54.3828 103.715 61.8069 101.605 70.3434 101.082C65.2222 88.1449 63.986 76.8242 64.9803 66.7442C66.1285 55.1033 70.23 45.3874 74.228 37.1201C75.0811 35.3561 75.9012 33.7135 76.6879 32.1378C77.8017 29.9069 78.8486 27.81 79.8278 25.6916C81.4579 22.1652 82.6674 19.051 83.2791 16.1576C83.8806 13.3125 83.8838 10.7715 83.1727 8.3342C82.4607 5.89352 80.9475 3.26635 78.0704 0.386692C74.3134 -0.587559 70.1448 0.267767 67.0197 3.08162L29.9298 36.4772C27.861 38.34 26.503 40.8642 26.0879 43.6182L22.8899 64.8384C27.9185 69.2873 40.33 82.2201 47.8789 100.165C48.5525 101.766 49.1875 103.408 49.775 105.089Z" fill="white"/><path d="M21.3902 74.5293C21.2153 75.2761 20.9692 76.0051 20.6549 76.7063L1.05225 120.436C-0.961131 124.928 -0.0336421 130.194 3.39276 133.726L34.2418 165.523C49.9952 142.262 47.6984 120.379 40.5026 103.274C35.0465 90.3037 26.777 80.1526 21.3902 74.5293Z" fill="white"/><path d="M41.3687 169.269C41.9093 169.355 42.4575 169.407 43.0096 169.424C48.864 169.6 58.7098 170.109 66.6947 171.582C73.2088 172.783 86.1213 176.397 96.747 179.505C104.855 181.877 113.211 175.396 114.387 167.024C115.245 160.917 116.855 154.009 119.821 147.677L119.753 147.702C114.73 133.682 108.34 124.629 101.641 118.849C94.9619 113.086 87.7708 110.397 80.8276 109.42C69.2835 107.795 58.7071 110.832 52.0453 112.791C56.0353 129.428 54.8074 149.004 41.3687 169.269Z" fill="white"/><path d="M124.96 139.034C131.626 128.965 136.375 121.134 138.881 116.888C140.135 114.764 139.907 112.102 138.423 110.133C134.554 105.002 127.152 94.5755 123.12 84.9218C118.973 74.9962 118.355 59.5866 118.319 52.081C118.306 49.2279 117.402 46.4413 115.639 44.1994L91.6762 13.73C91.5918 15.1034 91.3946 16.4659 91.1093 17.8158C90.3118 21.5882 88.8073 25.3437 87.0916 29.0552C86.086 31.2306 84.9238 33.5612 83.7497 35.9157C82.9682 37.4827 82.1814 39.0607 81.432 40.6102C77.5579 48.6212 73.9528 57.3151 72.9451 67.5313C72.011 77.0006 73.2894 88.014 79.0482 101.162C80.0074 101.243 80.9727 101.351 81.9422 101.487C90.2067 102.651 98.8807 105.891 106.866 112.781C113.73 118.704 119.932 127.19 124.96 139.034Z" fill="white"/></svg>');
  position: absolute;
  background-color: var(--background-modifier-hover);
  width: 15%;
  height: 15%;
  pointer-events: none;
  content: "";
}

.empty-state-title {
  display: none;
}

.empty-state-action-list {
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: center;
  gap: 8px;
  margin: 0;
  padding-top: var(--header-height);
  width: 100%;
  max-width: var(--file-line-width);
  height: 100%;
}

.empty-state-action {
  cursor: pointer;
}
.empty-state-action.mod-close {
  display: none;
}

.empty-state-action:first-child {
  width: 100%;
  height: 100%;
  font-weight: var(--inline-title-weight);
  font-size: var(--inline-title-size);
  line-height: var(--inline-title-line-height);
  text-align: left;

  &::after {
    content: "...";
  }
}

.empty-state-action:nth-child(2) {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
  cursor: text;
  border: var(--input-border-width) solid var(--background-modifier-border);
  border-radius: var(--radius-l);
  background: var(--background-modifier-hover);
  padding: 4px 16px;
  width: 100%;
  color: var(--text-normal);
  text-align: left;

  &::before {
    -webkit-mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><circle cx='11' cy='11' r='8'></circle><line x1='21' y1='21' x2='16.65' y2='16.65'></line></svg>");
    -webkit-mask-repeat: no-repeat;
    display: block;
    background-color: var(--search-icon-color);
    width: var(--search-icon-size);
    height: var(--search-icon-size);
    content: "";
  }
}

body.is-mobile {
  .empty-state-container {
    padding: 0;
  }
  .empty-state-action-list {
    gap: 0;
    margin: var(--file-margins);
    padding-top: 0;
    padding-bottom: 80px;
  }
  .empty-state-action {
    background-color: transparent;
    padding: 0;
  }
  .empty-state-action:first-child {
    padding-top: calc(var(--safe-area-inset-top) + var(--view-header-height) + 16px);
  }
  .empty-state-action:nth-child(2) {
    background-color: var(--background-secondary) !important;
    padding: 4px 16px;
  }
}

/********** Settings **********/

body:not(.is-phone) {
  &.theme-dark .modal.mod-settings,
  .vertical-tab-content {
    background-color: rgb(from var(--background-secondary) r g b / 75%);
  }

  .modal {
    backdrop-filter: blur(50px);
    box-shadow: var(--shadow-l);

    &,
    .vertical-tab-content,
    .community-modal-details {
      background-color: rgb(from var(--background-primary) r g b / 75%);
    }
    .vertical-tab-header {
      background-color: transparent;
    }
    .vertical-tab-content-container,
    .community-modal-details {
      margin: 1px 1px 1px 0;
    }

    .modal-sidebar {
      background-color: transparent;
    }

    .installed-plugins-container {
      border: none;
      padding: 0;
    }
  }
}

body:not(.mod-windows):not(.is-mobile),
body.force-macos {
  .modal:not(.mod-community-modal) {
    .setting-item-heading {
      border: none;
      padding: 16px 16px 12px;
    }
    .setting-item:not(.setting-item-heading) {
      border-right: 1px solid var(--background-modifier-border);
      border-left: 1px solid var(--background-modifier-border);
      border-radius: 0;
      background-color: var(--background-primary);
      padding: 12px 16px;
    }
    .setting-item-heading + .setting-item,
    *:not(.setting-item) + .setting-item,
    .setting-item:first-child:not(.setting-item-heading) {
      border-top: 1px solid var(--background-modifier-border);
      border-top-right-radius: var(--radius-s) !important;
      border-top-left-radius: var(--radius-s) !important;
    }
    .setting-item:has(+ .setting-item-heading),
    .setting-item:has(+ *:not(.setting-item)):not(.setting-item-heading),
    .setting-item:last-child {
      border-bottom: 1px solid var(--background-modifier-border);
      border-bottom-right-radius: var(--radius-s) !important;
      border-bottom-left-radius: var(--radius-s) !important;
    }
    .setting-item-info:has(.setting-item-name:empty) .setting-item-description {
      padding: 0;
    }
  }

  .mobile-option-setting-item {
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--radius-s);
    padding: 12px 16px;
  }
}

body.is-mobile {
  .setting-item-control {
    align-items: center;
  }
}

body.is-phone {
  &.theme-dark .modal.mod-settings,
  &.theme-dark .modal.mod-community-modal {
    .modal-header,
    .vertical-tab-header,
    .vertical-tab-content,
    .modal-sidebar,
    .community-modal-details {
      background-color: var(--background-primary);
    }

    .community-item {
      background-color: var(--interactive-normal);
    }
  }

  .modal.mod-settings,
  .modal.mod-community-modal {
    --divider-color: var(--background-primary);
    background-color: transparent;

    .modal-header,
    .modal-sidebar {
      border: none !important;
      background-color: var(--background-secondary);
    }

    .vertical-tab-header,
    .vertical-tab-content {
      background-color: var(--background-secondary);
      padding-right: 16px;
      padding-left: 16px;
    }

    .vertical-tab-nav-item {
      height: unset;
      min-height: var(--input-height);
      word-break: break-word;
    }

    .vertical-tab-header-group-title {
      padding: 8px;
      color: var(--text-faint);
      font-weight: normal;
      font-size: var(--font-ui-small);
      text-transform: uppercase;
    }

    .vertical-tab-header-group-items {
      border-radius: var(--input-radius);
      background-color: var(--interactive-normal);
      overflow: hidden;
    }

    .community-modal-search-results-wrapper {
      border: none;
      padding: 0 16px;
    }

    .community-modal-search-results {
      gap: 8px;
    }

    .community-item {
      border: none;
      border-radius: var(--input-radius);
    }

    .community-modal-details {
      background-color: var(--background-secondary);
    }
  }

  .setting-item {
    border: none;
  }
  .setting-item:not(.mod-toggle) .setting-item-info {
    padding: 0 8px;
  }

  .setting-item.mod-toggle,
  .setting-item-control .mobile-option-setting-item {
    border-radius: var(--input-radius);
    background-color: var(--interactive-normal) !important;
    padding: 12px 16px;
  }

  .setting-item.mod-toggle:has(+ .setting-item.mod-toggle) {
    border-bottom: 1px solid var(--background-modifier-border);
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
  }

  .setting-item.mod-toggle + .setting-item.mod-toggle {
    border-top-right-radius: 0;
    border-top-left-radius: 0;
  }

  .setting-item-control .clickable-icon {
    background-color: var(--interactive-normal);
    min-width: var(--input-height);
    height: var(--input-height);
  }

  .setting-item-control:not(:has(:not(button))) {
    flex-direction: column;
    gap: 0;
    border-radius: var(--input-radius);
    overflow: hidden;
  }

  .setting-item-control:not(:has(:not(button))) > button {
    border-radius: 0;

    &:not(:last-child) {
      border-bottom: 1px solid var(--background-modifier-border);
    }
  }
}

body.is-tablet {
  .modal:not(.mod-community-modal) {
    textarea,
    input[type="text"]:not(.metadata-container *):not(.prompt *),
    input[type="number"],
    input[type="search"]:not(.search-input-container > *),
    button:not(.clickable-icon),
    select,
    .dropdown {
      background-color: var(--background-secondary);
    }
    button.mod-cta {
      color: var(--text-accent);
    }
    .setting-item:not(.setting-item-heading) {
      border-right: none;
      border-left: none;
    }
    .setting-item-heading + .setting-item,
    *:not(.setting-item) + .setting-item,
    .setting-item:first-child:not(.setting-item-heading) {
      border-top: none;
    }
    .setting-item:has(+ .setting-item-heading),
    .setting-item:has(+ *:not(.setting-item)):not(.setting-item-heading),
    .setting-item:last-child {
      border-bottom: none;
    }
  }
}

/********** Desktop: Status Bar **********/
body:not(.center-status-off) .status-bar {
  right: 50%;
  bottom: 12px;
  transform: translateX(50%);
}

.status-bar {
  right: 8px;
  bottom: 8px;
  opacity: 0.1;
  transition: var(--anim-duration-fast);
  border: 1px solid transparent;
  border-radius: var(--radius-xl);
  background-color: transparent;
  padding: 4px;
  color: var(--text-muted);
}

.status-bar:hover {
  opacity: 1;
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-primary);
}

.status-bar * {
  white-space: nowrap;
}

/********** Desktop: Tooltip **********/
.tooltip {
  color: var(--text-muted);
}

.tooltip-arrow {
  display: none;
}

/********** Desktop: Notice **********/
.notice-container {
  display: flex;
  top: unset;
  bottom: 16px;
  flex-direction: column-reverse;
  gap: 8px;
}

.notice {
  backdrop-filter: blur(20px);
  margin-bottom: 0;
  border: 1px solid var(--background-modifier-border);
  border-radius: var(--radius-l);
  background-color: var(--modal-background);
  padding: 16px 24px;
  overflow: hidden;
  color: var(--text-muted);
}

/********** Desktop: Windows specific styling **********/

body.mod-windows:not(.force-macos):not(.is-mobile) {
  --font-text-theme: "Fluent System Icons", "Segoe UI Variable", "Segoe UI", "Microsoft Jhenghei", "Microsoft Yahei", "Yu Gothic UI", "Malgun Gothic", sans-serif;
  --font-interface-theme: "Fluent System Icons", "Segoe UI Variable", "Segoe UI", "Microsoft Jhenghei", "Microsoft Yahei", "Yu Gothic UI", "Malgun Gothic", sans-serif;
  --input-height: 32px;
  --dialog-width: 448px;
  --radius-l: 8px;
  --radius-m: 4px;
  --radius-s: 4px;
  --radius-xl: 8px;
  --toggle-thumb-height: 12px;
  --toggle-thumb-width: 12px;
  --toggle-width: 40px;
  --toggle-border-width: 4px;
  --slider-thumb-border-width: 4px;
  --slider-thumb-border-color: var(--background-secondary-alt);
  --slider-track-background: var(--background-modifier-border-hover);
  --workspace-background-translucent: rgb(from var(--background-primary) r g b / 90%);

  &.theme-light {
    --shadow-l: 0px 32px 64px 0px rgba(0, 0, 0, 0.28), 0px 2px 21px 0px rgba(0, 0, 0, 0.22) !important;
    --shadow-s: 0px 8px 16px 0px rgba(0, 0, 0, 0.14);
    --input-shadow: 0 -0.5px 0 0 rgba(0, 0, 0, 0.15) inset !important;
    --interactive-normal: var(--background-primary-alt);
  }
  &.theme-dark {
    --shadow-l: 0px 32px 64px 0px rgba(0, 0, 0, 0.56), 0px 2px 21px 0px rgba(0, 0, 0, 0.55) !important;
    --shadow-s: 0px 8px 16px 0px rgba(0, 0, 0, 0.26);
    --input-shadow: 0 0.5px 0 0 rgba(255, 255, 255, 0.1) inset !important;
    --interactive-normal: var(--background-secondary-alt);

    *:not(.mod-root) {
      --divider-color: rgba(0, 0, 0, 0.2) !important;
    }
  }

  /********** Components **********/

  textarea,
  input[type="text"]:not(.metadata-container *):not(.prompt *),
  input[type="number"],
  input[type="search"],
  button:not(.clickable-icon),
  select,
  .dropdown {
    outline: 1px solid var(--background-modifier-border);
    border: none;
    min-height: var(--input-height);
  }

  button:not(.view-header button),
  select,
  .dropdown {
    padding: 6px 16px;
  }

  select,
  .dropdown {
    padding: 6px 32px 6px 16px;
  }

  button[class*="mod-"] {
    box-shadow: var(--input-shadow) !important;

    &::before {
      display: none;
    }
  }

  input[type="text"]:not(.metadata-container *):not(.prompt *),
  input[type="number"] {
    padding-left: 16px;

    &:active,
    &:focus,
    &:focus-visible {
      box-shadow: 0 -1px 0 0 var(--interactive-accent) inset !important;
      border-color: var(--background-modifier-border) !important;
    }
  }

  input[type="search"]:active,
  input[type="search"]:focus,
  input[type="search"]:focus-visible {
    box-shadow: 0 -1px 0 0 var(--interactive-accent) inset !important;
    border-color: var(--background-modifier-border) !important;
  }

  input[type="range"]::-webkit-slider-thumb {
    background-color: var(--interactive-accent);
  }

  .checkbox-container {
    box-shadow: none;
  }

  /********** Editor **********/

  .mod-root .workspace-tab-container {
    box-shadow: none !important;
    border: 1px solid var(--background-modifier-hover);
  }

  /********** Sidebar **********/

  .mod-sidedock .workspace-leaf {
    animation: fadeInUp var(--anim-duration-moderate);
  }

  .nav-action-button {
    padding: 8px;
  }

  .nav-action-button.is-active::after {
    position: absolute;
    bottom: 0;
    border-radius: var(--radius-l);
    background-color: var(--interactive-accent);
    width: 24px;
    height: 3px;
    content: "";
  }

  .tree-item-self.is-active::after,
  .vertical-tab-nav-item.is-active::after {
    position: absolute;
    top: 8px;
    bottom: 8px;
    left: 0;
    border-radius: var(--radius-l);
    background-color: var(--interactive-accent);
    width: 4px;
    content: "";
  }

  /********** Settings **********/

  &.theme-dark {
    .modal.mod-settings .setting-item:not(.setting-item-heading) {
      background-color: var(--background-secondary);
    }
  }

  .modal.mod-settings {
    .vertical-tab-header {
      border: none;
    }

    .vertical-tab-header-group-title {
      padding: var(--nav-item-padding);
    }
    .vertical-tab-content-container {
      animation: fadeInUp var(--anim-duration-moderate);
    }
    .vertical-tab-content {
      background-color: transparent !important;
    }
    .vertical-tab-nav-item {
      position: relative;
      padding: var(--nav-item-padding);

      &.is-active {
        --background-modifier-hover: unset;
        background-color: var(--background-modifier-hover);
        color: var(--text-normal);
      }
    }

    .setting-item-heading {
      padding: 16px 16px 12px;
    }
    .setting-item-heading .setting-item-name {
      font-size: var(--font-ui-large);
    }
    .setting-item:not(.setting-item-heading) {
      border: none;
      border-radius: var(--radius-m);
      background-color: var(--background-primary);
      padding: 16px 20px;
    }
    .setting-item:not(:last-child):not(.setting-item-heading) {
      margin-bottom: 4px;
    }
  }

  /********** Menu and Suggestions **********/
  .menu,
  .suggestion-container {
    outline: none;
    border: 1px solid var(--background-modifier-border-hover);
    border-radius: calc(var(--radius-m) + 6px);
    background-color: var(--background-secondary);
    padding: 6px;

    .menu-separator {
      margin: 6px 0;
      background-color: var(--background-modifier-border-hover);
    }

    .menu-item,
    .suggestion-item {
      justify-content: flex-start;
      border-radius: var(--radius-m);
      padding: 8px;
      min-width: 200px;
    }
    .menu-item.selected:not(.is-label):not(.is-disabled),
    .suggestion-item.is-selected:not(.mod-group) {
      background-color: var(--background-modifier-hover);
      color: var(--text-normal);

      .menu-item-icon {
        color: var(--text-normal);
      }
    }

    .search-suggest-info-text {
      color: var(--text-normal);
    }
  }

  /********** Modal **********/
  .modal {
    backdrop-filter: blur(240px);

    textarea,
    input[type="text"]:not(.metadata-container *):not(.prompt *),
    input[type="number"],
    input[type="search"],
    button:not(.clickable-icon),
    select,
    .dropdown {
      min-width: 120px;
    }
  }

  .modal:not(.mod-settings):not(.mod-community-modal) {
    padding: 0;

    .modal-title,
    .modal-content,
    h1,
    h2,
    h3,
    p {
      text-align: left;
    }

    .modal-title {
      padding: 24px 24px 4px;
    }

    .modal-content {
      padding: 4px 24px 24px;
    }

    .modal-button-container {
      margin: 0;
      border-top: 1px solid var(--background-modifier-border);
      background-color: var(--divider-color);
      padding: 24px;
    }
  }

  /********** Prompt **********/
  .prompt-input {
    padding: 32px 24px;
    font-size: unset;
  }

  .prompt-results .suggestion-item {
    position: relative;
    padding: 12px;
  }

  .prompt-results .suggestion-item.is-selected::after {
    position: absolute;
    top: 12px;
    bottom: 12px;
    left: 0;
    border-radius: var(--radius-l);
    background-color: var(--interactive-accent);
    width: 4px;
    content: "";
  }
}

/********** Mobile: Top Bar **********/

body.is-mobile {
  .view-actions {
    padding: 0;
  }
}

body.is-phone {
  .workspace .mod-root .workspace-leaf .view-header {
    position: fixed;
    background-color: transparent;
    padding-top: var(--safe-area-inset-top);
    width: 100%;
    height: fit-content;

    &::before {
      position: absolute;
      top: 0;
      left: 0;
      z-index: -1;
      backdrop-filter: blur(50px);
      background-color: rgb(from var(--background-primary) r g b / 50%) !important;
      width: 100%;
      height: 100%;
      content: "";
    }

    .view-actions button:nth-last-child(2) {
      position: fixed;
      right: 16px;
      bottom: 16px;
      backdrop-filter: blur(50px);
      border: 1px solid var(--background-modifier-border);
      border-radius: 100%;
      background-color: var(--modal-background);
      padding: 16px;
      width: 56px;
      height: 56px;
      color: var(--text-normal);
    }

    &:has(.view-header-breadcrumb) .view-header-title-container {
      justify-content: flex-start;
      padding: 0 8px;
    }

    &:has(.view-header-breadcrumb) .view-header-left {
      display: none;
    }

    .view-header-left,
    .view-header-title-container {
      flex-grow: 0;
    }

    .view-header-title-parent .view-header-breadcrumb {
      padding: 0;
    }

    .view-header-title-parent .view-header-breadcrumb-separator,
    .view-header-title {
      opacity: 0.5;
      color: var(--text-normal);
    }

    .view-header-title-parent:not(:empty) {
      display: flex;
      align-items: center;
      gap: 4px;
      opacity: 1;
    }

    .view-header-breadcrumb:first-child {
      opacity: 1;
      color: var(--interactive-accent);
      font-weight: bold;
    }
  }

  &:has(.mobile-navbar) .view-actions button:nth-last-child(2) {
    margin-bottom: 80px;
  }
}

/********** Mobile: Pull Action **********/

.pull-action {
  backdrop-filter: blur(20px);
  animation: fadeInDown var(--anim-duration-moderate);
  box-shadow: var(--shadow-s);
  border: 1px solid var(--background-modifier-border);
  background-color: var(--modal-background);
  padding: 12px 24px;
  width: fit-content;
  font-weight: 600;
}

/********** Mobile: Bottom Bar **********/

body.is-mobile {
  &.theme-light {
    .workspace-drawer .nav-header {
      background-color: rgb(from var(--background-secondary) r g b / 75%);
    }
  }

  .mobile-navbar,
  .workspace-drawer .nav-header {
    position: fixed;
    bottom: 0;
    left: 0;
    z-index: var(--layer-status-bar);
    backdrop-filter: blur(50px);
    border: none;
    background-color: rgb(from var(--background-primary) r g b / 50%);
    padding: 4px max(var(--safe-area-inset-right), 16px) max(4px, var(--safe-area-inset-bottom)) max(var(--safe-area-inset-left), 16px);
    width: 100%;
  }
  .mobile-navbar-action {
    display: flex;
    justify-content: center;
  }
  .mobile-navbar-action .clickable-icon {
    width: 100%;
  }
  .mobile-navbar-tabs-action {
    border-width: var(--icon-l-stroke-width);
    border-radius: 30%;
    width: calc(var(--icon-size) - 2px);
    height: calc(var(--icon-size) - 2px);
  }

  .mobile-toolbar {
    background-color: var(--background-secondary);
  }
  .mobile-toolbar-option {
    color: var(--text-normal);
  }
  .mobile-toolbar-options-list {
    padding: 0;
  }

  .mobile-tab-switcher-menubar {
    padding: 4px max(var(--safe-area-inset-right), 16px) max(4px, var(--safe-area-inset-bottom)) max(var(--safe-area-inset-left), 16px);
  }

  .nav-buttons-container {
    justify-content: space-between;
  }
  .nav-action-button {
    flex-grow: 0 !important;
  }
}

/********** Mobile: Image Viewer **********/

body.is-mobile {
  .mobile-image-viewer {
    animation: var(--anim-duration-fast) fadeInScale;
    background-color: transparent;
  }
  .mobile-image-viewer img {
    border-radius: 0;
  }
}

/********** Core Plugin: Canvas **********/

.canvas-wrapper {
  --shadow-stationary: 0px 1px 2px rgba(0, 0, 0, 0.028), 0px 3.4px 6.7px rgba(0, 0, 0, 0.042), 0px 15px 30px rgba(0, 0, 0, 0.07);
}

.canvas-control-group {
  backdrop-filter: blur(50px);
  box-shadow: none;
  background-color: rgb(from var(--background-primary) r g b / 50%);
}

.canvas-control-item {
  --icon-size: var(--icon-m);
  background-color: transparent;
}

.canvas-card-menu {
  gap: 8px;
  box-shadow: none;
  border: 1px solid var(--background-modifier-border);
  padding: 8px;
}

.canvas-card-menu-button {
  border-radius: var(--input-radius);
  padding: 16px;

  &:hover {
    background-color: var(--background-modifier-hover);

    svg {
      transform: none !important;
      fill: none !important;
    }
  }
}

.canvas-node-container {
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary);
}
.canvas-node-label {
  left: 2px;
  transition: var(--anim-duration-fast) var(--anim-duration-slow);
}

.canvas-node-container:not(:hover) + .canvas-node-label {
  top: 20px;
  opacity: 0;
  z-index: -1;
}

body.is-phone {
  .canvas-controls {
    top: calc(var(--safe-area-inset-top) + var(--view-header-height) + 8px);
  }
}

/********** Core Plugin: Graph **********/

.graph-controls.is-close {
  backdrop-filter: blur(50px);
  border: 1px solid var(--background-modifier-border);
  background-color: rgb(from var(--background-primary) r g b / 50%);
  padding: 0;
}
.graph-controls-button {
  padding: 8px;
}
.graph-controls-button.mod-open {
  border-bottom: 1px solid var(--background-modifier-border);
  border-radius: 0;
}
.graph-controls-button.mod-animate {
  margin: 0 !important;
}

/********** Community Plugin: Style Settings **********/

.style-settings-container {
  padding: 0;
}

.style-settings-heading {
  margin: 0 !important;
  border: none !important;
}

/********** Community Plugin: Linter **********/

.linter-setting-title {
  align-items: center;

  h1 {
    font-weight: 700;
  }
  .linter-no-border {
    border: none !important;
    background-color: transparent !important;
    padding: 0 !important;
  }
}

.linter-setting-tab-group {
  gap: 4px;
  border: none;
}

.linter-navigation-item {
  box-sizing: border-box !important;
  border-radius: var(--radius-l);
  padding: 8px !important;
  max-width: unset !important;
  height: unset;
  line-height: 100%;

  &.linter-navigation-item-selected {
    border: 1px solid transparent;
    padding: 8px 12px !important;
  }

  &:hover {
    border: 1px solid var(--interactive-accent);
  }
}

.linter-setting-content {
  .linter-tab-settings {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .setting-item-heading:has(.setting-item-control:empty) {
    display: none;
  }
  .setting-item:has(+ .linter-visually-hidden) {
    border-bottom: 1px solid var(--background-modifier-border);
    border-bottom-right-radius: var(--radius-s) !important;
    border-bottom-left-radius: var(--radius-s) !important;
  }

  div:not(.setting-item) > .setting-item-info {
    padding: 16px 16px 12px;
  }
  div:has(.setting-item:not(:only-child)) > .setting-item-name {
    padding: 16px 16px 0;
  }
  div:has(.setting-item:not(:only-child)) > .setting-item-description {
    padding: 0 16px;
  }

  textarea.full-width {
    margin: 0;
    box-shadow: none;
    border: var(--input-border-width) solid var(--background-modifier-border);
  }
}

/********** Community Plugin: Kanban **********/

.kanban-plugin {
  background-color: transparent;

  a:hover {
    text-decoration: none;
  }
}

/********** Community Plugin: Tasks **********/

.modal:has(.tasks-modal) {
  --dialog-width: fit-content;

  .accesskey {
    text-decoration: none;
  }

  hr {
    visibility: hidden;
  }

  .tasks-modal-priority-section,
  .tasks-modal-dates-section,
  .tasks-modal-dependencies-section {
    box-sizing: border-box;
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--radius-m);
    background-color: var(--background-primary);
    padding: 12px 16px;
  }

  .tasks-modal-button-section {
    background-color: transparent;
  }
}

/********** Community Plugin: Calendar **********/

#calendar-container {
  padding: 0;

  .title {
    font-size: unset;
  }

  .right-nav {
    align-items: center;
  }

  .day {
    border-radius: var(--radius-m);
    padding: 8px;
  }

  .today,
  .active {
    background-color: var(--color-text-today);
    color: var(--text-on-accent);
    --color-dot: var(--text-on-accent);
  }
}

/********** Community Plugin: Ink **********/

.ink_writing-embed,
.ddc_ink_drawing-embed {
  padding: 0;

  .ink_write_primary-menu-bar {
    padding: 8px 12px;
  }

  .ddc_ink_writing-editor,
  .ddc_ink_writing-preview,
  .ddc_ink_drawing-editor,
  .ddc_ink_drawing-preview,
  .tl-canvas {
    border-radius: var(--radius-s);
  }

  .ddc_ink_visible-frame {
    border: 1px solid var(--background-modifier-border) !important;
  }

  .ddc_ink_visible-background,
  .tl-canvas {
    border: 1px solid var(--background-modifier-border);
    background-color: var(--background-primary-alt);
  }

  button {
    box-shadow: none !important;
    border-radius: var(--input-radius);
    padding: 8px;
    height: 2.5em !important;

    &:not(:disabled) {
      background-color: transparent;
    }
  }
}

/********** Community Plugin: Note Toolbar **********/

.note-toolbar-setting-toolbar-list,
.note-toolbar-setting-item-visibility {
  padding: 0 !important;
}
.note-toolbar-setting-items-list-container .setting-item.mod-toggle {
  padding: 12px 16px;
}
.note-toolbar-setting-item-style {
  .setting-item,
  & .setting-item-control,
  & select[class="dropdown"] {
    border-radius: var(--input-radius) !important;
  }

  .setting-item:not(:last-child),
  .setting-item:first-child {
    border: none !important;
    background-color: var(--tag-background) !important;
  }

  .setting-item-name,
  .setting-item-control {
    --icon-color: var(--tag-color);
    color: var(--tag-color);
  }
}
.note-toolbar-sortablejs-list {
  gap: 8px;
}
.note-toolbar-setting-item[data-active="true"] {
  box-shadow: none;
  border: none;
  background-color: var(--background-modifier-hover);
  padding: 0;
}
.note-toolbar-setting-item .sortable-handle,
.note-toolbar-setting-item-controls .sortable-handle {
  background-color: transparent !important;
}
.note-toolbar-setting-item-controls {
  align-items: center;
}
.note-toolbar-setting-item-icon .setting-item-control {
  border: none;
  padding: 0 !important;
}
.note-toolbar-setting-items-button-container,
.note-toolbar-setting-items-button-container .setting-item {
  border: none !important;
}

.note-toolbar-setting-modal-container {
  .setting-item {
    margin-top: 0 !important;
  }
  .setting-item-info {
    margin: 0;
  }

  .note-toolbar-setting-modal {
    background-color: transparent !important;
    padding: 0;
    text-align: left;
  }

  .extra-setting-button[aria-label="Remove"] {
    --input-height: 24px;
    background-color: transparent !important;
    padding: 4px;
  }
  button[aria-label="Add a new item to the toolbar"] {
    color: var(--text-on-accent) !important;
  }
}

.note-toolbar-setting-dialog-phonefix {
  padding: 16px !important;
}

body:not(.is-phone) {
  .note-toolbar-setting-button,
  .note-toolbar-setting-item-icon,
  .note-toolbar-setting-item-field,
  .note-toolbar-setting-item-field-link,
  .note-toolbar-setting-item-link-container .setting-item,
  .note-toolbar-setting-item-delete,
  .note-toolbar-setting-item-visibility,
  .note-toolbar-setting-item-visibility-and-controls,
  .note-toolbar-setting-item-visibility-and-controls button,
  .note-toolbar-setting-import-text-area {
    border: none !important;
    background-color: transparent !important;
  }

  .note-toolbar-setting-item-top-container,
  .note-toolbar-setting-item-icon,
  .note-toolbar-setting-item-field,
  .note-toolbar-setting-item-field-link,
  .note-toolbar-setting-item-link-container .setting-item,
  .note-toolbar-setting-item-visibility-and-controls,
  .note-toolbar-setting-import-text-area {
    padding: 8px !important;
  }

  .note-toolbar-setting-item-fields,
  .note-toolbar-setting-item-link-container {
    gap: 8px;

    select.dropdown {
      width: 100%;
    }

    input[type="search"] {
      box-shadow: var(--input-shadow);
    }
  }

  .note-toolbar-setting-mini-dialog {
    width: unset;
  }

  .note-toolbar-setting-modal-container {
    width: var(--prompt-width);
  }
}

body.is-phone {
  .note-toolbar-setting-modal-container {
    padding-bottom: var(--safe-area-inset-bottom) !important;
    width: 100% !important;
  }
}

/********** Community Plugin: Omnisearch **********/

.omnisearch-result > div {
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: 100%;
}

.omnisearch-result__icon {
  display: none;
}
.omnisearch-result__title {
  align-items: baseline;
  width: 100%;
}
.omnisearch-result__extension {
  flex-grow: 1;
}
.omnisearch-result__body {
  margin: 0;
  width: 100%;
}
.omnisearch-highlight {
  text-decoration: none;
}

body.is-phone {
  &.theme-dark .omnisearch-input-field {
    background: linear-gradient(180deg, rgba(43, 43, 43, 0) 0%, rgba(43, 43, 43, 1) 80%);
  }
  &:has(.omnisearch-modal.prompt) .app-container {
    filter: none;
  }

  .omnisearch-modal {
    --text-muted: rgba(var(--mono-rgb-0), 0.5);
    backdrop-filter: blur(20px) brightness(0.5);
    border-radius: var(--radius-l) var(--radius-l) 0 0;
    height: 85%;

    .prompt-results {
      padding-top: 12px;
      color: white;
    }

    .omnisearch-input-field {
      position: absolute;
      bottom: 0;
      z-index: var(--layer-cover);
      background: linear-gradient(180deg, rgba(209, 211, 218, 0) 0%, rgba(209, 211, 218, 1) 100%);
      padding: 8px;
      width: 100%;

      input.prompt-input {
        margin: 0;
        padding-right: 120px;
      }
    }

    .omnisearch-input-container__buttons {
      position: absolute;
      right: 8px;
      bottom: 8px;
      padding: 0;
      width: unset;

      button {
        background-color: transparent !important;
      }
    }

    .omnisearch-highlight {
      color: white;
    }
  }
}

/********** Community Plugin: Trash Explorer **********/

.trash-item .buttons {
  gap: 8px !important;
}

/********** Community Plugin: Dataview **********/
.dataview.table-view-table {
  position: relative;
}
.dataview.table-view-table::before {
  position: absolute;
  inset: 0;
  border: var(--table-border-width) solid var(--table-border-color);
  border-radius: var(--radius-s);
  width: calc(100% - 2px);
  height: calc(100% - 2px);
  pointer-events: none;
  content: "";
}

.table-view-th {
  border-bottom: var(--table-border-width) solid var(--table-border-color) !important;
  font-size: unset !important;
}

/********** Community Plugin: Tldraw **********/
body:has(.tl-theme__light) {
  --color-background: hsl(210, 20%, 98%);
  --color-low: hsl(204, 16%, 94%);
  --color-text: hsl(0, 0%, 0%);
}

body:has(.tl-theme__dark) {
  --color-background: hsl(240, 5%, 6.5%);
  --color-low: hsl(260, 4.5%, 10.5%);
  --color-text: hsl(210, 17%, 98%);
}

body:has(.tldraw-view-content) .status-bar {
  display: none;
}

body:not(.is-mobile) {
  .tldraw-view-content {
    padding-bottom: 0 !important;
  }
}

body.is-phone {
  .workspace-leaf-content:has(.tldraw-view-content) .view-actions button:nth-last-child(2) {
    top: calc(var(--safe-area-inset-top) + var(--view-header-height) + 1px) !important;
    right: 0 !important;
    bottom: unset !important;
    backdrop-filter: none !important;
    border: none !important;
    border-radius: 0 0 0 11px !important;
    background: var(--color-low) !important;
    padding: 8px !important;
    width: 40px !important;
    height: 40px !important;
    color: var(--color-text) !important;

    svg.svg-icon {
      fill: none;
    }
  }

  .tldraw-view-content {
    margin-top: calc(var(--safe-area-inset-top) + var(--view-header-height) + 1px) !important;
    padding-bottom: 79px !important;
  }
}

.tldraw-view-content {
  button {
    box-shadow: none !important;
    height: 40px !important;
  }

  button:not(.clickable-icon).mobile-tap {
    background-color: hsl(0, 0%, 0%, 5.5%);
  }

  .tlui-button__menu {
    padding: 0 16px;
  }
}
